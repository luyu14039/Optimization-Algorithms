# 萤火虫优化算法（FA,  Firefly Algorithm）

**建立模型、描述输入输出关系（线性、非线性）的方法/框架：**

神经网络(BP等)

决策树（多颗决策树—>随机森林）等等

**优化方法：**

遗传（GA）

粒子群（PSO）

蚁群（ACA）

模拟退火（SA）等等

## 背景

目的是为了寻找问题的最优解或近似最优解，采用的方法是智能优化算法。

智能优化算法通过模拟自然进化、群体行为、物理现象等现象或过程，实现寻找复杂问题的最优解。因为现实的生物行为可是看作三维空间场景下的优化问题，生物自行解决了。例如黏菌在迷宫会自发按走出迷宫、得到食物的最短路径生长。将这些生物行为机制模拟成计算机的策略机制，就可以用来优化其他（甚至更高）维度的问题。

萤火虫算法是一种启发式优化算法，灵感是自然界中萤火虫的闪烁行为。

## FA萤火虫算法原理

**萤火虫行为**：寻找食物，发光。

**核心**：萤火虫会向比自己亮度更高的个体靠近

**解读**：离食物越近它的位置就越好，同时萤火虫会发光，光强越大，说明离食物越近（适应度就越好），同时光强越大对其他萤火虫个体的吸引就越强。

也就是说适应度可以用来表示光强，二者一个意思。适应度越好，这个“好”具体值由目标函数确定，可能是越大越好或越小越好。不区分萤火虫性别

亮度和吸引力成正比

转化为求最值问题

## FA步骤

### 	初始化种群

1. 生成维度D，含有N个个体的一个种群

$$
X=lb+(ub-lb)\times rand(N,D)
$$

​			lb为最小值，ub为最大值，每个个体位置是一个D维向量，这样做保证了范围在最大最小之间。

2. 个体光强$I$

$$
I_{r}=I_{0}e^{-\gamma r^{2}}
$$

​			r为离该发光个体距离，个体发光是有可见范围的，越远越暗。$\gamma$是**手动设置的**参数。

3. 个体吸引度，和光强成正比，套用光强公式，$\beta$是**手动设置的**。

$$
\beta_{r}=\beta_{0}e^{-\gamma r^{2}}
$$



4. 个体距离--欧式距离

$$
r_{ij}=||X_{i}-X_{j}||=\sqrt {\sum_{k=1}^{D} (x_{i,k}-x_{j,k})^2}
$$

5. 个体移动

个体吸引力更大，那么个体i向j移动（迭代/更新一次），第二项是吸引，

第三项是增加多样性的策略。没有第三项就是完全吸引模型。rand-1/2保证了随机数在±1/2，也就是可以往所有方向偏移。$\alpha$是**手动设置的**。
$$
X_{id}(t+1)=X_{id}(t)+
\underbrace{\beta_{0}e^{-\gamma r_{ij}^{2}}(X_{jd}(t)-X_{id}(t))}_{attraction}+
\underbrace{\alpha (rand-\frac{1}{2})}_{randomization}
$$

### 	迭代

6. 适应度函数是手动定的

<img src="../萤火虫优化算法/传统FA流程图.jpg" alt="传统FA流程图" style="zoom: 10%;" />

### 结果

两次结果不一定一样，有随机性

## FA算法改进----ApFA

传统FA算法优点在于：

1. 结构简单，容易实现

2. 收敛速度快（快速飞向食物，但易导致找到的只是局部最优而非全局最优的问题，提示优化方向：多样性）

缺点：

1. 初始参数$\beta,\alpha,\gamma$是用户自己设置而且迭代中一直不变。**提示优化方向**：参数随迭代动态改变。

2. 收敛速度快是快速飞向食物，也就是完全吸引，但易导致找到的只是局部最优而非全局最优的问题，也就**提示了优化方向**：考虑多样性。多样性和收敛性应该追求平衡。

   前期可以侧重多样性，后期侧重收敛性。参数如何改变？可以引入t(因为已知t是递增的)辅助这种$\alpha$先大后小的变化，在迭代循环里改。
   $$
   \alpha(t+1)=(1-\frac{t}{G_{max}})\alpha(t)
   $$
   


$$
\beta_{0}(t+1)=
\begin{cases}
rand_{1} & \text{if } rand_{2} < 0.5 \\
\beta_{0}(t) & \text{else } 
\end{cases}
$$
